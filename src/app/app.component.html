<mat-toolbar
  color="primary"
  class="mat-elevation-z6"
  fxLayout="row"
  fxLayoutGap="10px"
>
  <span fxFlex="150px" fxHide.lt-sm>
    <a mat-button [routerLink]=""><h1>Miner Stats</h1></a>
  </span>

  <!-- This fills the remaining space of the current row -->
  <span fxFlex="calc(100% - 210px)">
    <form [formGroup]="filterForm" fxLayout="row" fxLayoutGap="15px">
      <mat-form-field fxFlex="50%" color="warning" floatLabel="never">
        <mat-select placeholder="Rig Profile" (selectionChange)="rigProfileSelected($event)" [value]="rigProfileUuid | async">
          <ng-container *ngIf="rigProfilesAvailable | async as rigProfiles">
            <mat-option *ngFor="let uuid of keys(rigProfiles)" [value]="uuid">
              {{rigProfiles[uuid].name}}
            </mat-option>
          </ng-container>
        </mat-select>
      </mat-form-field>
      <mat-form-field fxFlex="50%" floatLabel="never">
        <input matInput [formControlName]="'name'" placeholder="Filter" [matAutocomplete]="auto">
        <mat-autocomplete #auto="matAutocomplete">
          <mat-option *ngFor="let option of filterNameOptions | async" [value]="option">
            {{ option }}
          </mat-option>
        </mat-autocomplete>
        <button mat-button *ngIf="filterForm.value.name" matSuffix mat-icon-button (click)="clearFilter($event)">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>
    </form>
  </span>

  <span fxFlex="40px" fxLayout="row">
    <ng-container *ngIf="afAuth.authState | async as user; else showLogin">
      <button
        mat-icon-button
        matTooltip="Logout"
        (click)="logout()"
        class="avatar"
        ngClass.lt-sm="xs"
        fxLayoutAlign="end center"
      >
        <img [src]="user.photoURL">
      </button>
    </ng-container>
    <ng-template #showLogin>
      <button mat-button (click)="login()">Login</button>
    </ng-template>
  </span>
</mat-toolbar>

<div class="content" ngClass.lt-sm="xs">
  <ng-container *ngIf="afAuth.authState | async; else directToLogin">
    <router-outlet></router-outlet>
  </ng-container>

  <ng-template #directToLogin>
    <div fxLayout="column" fxLayoutAlign="center center" fx>
      <mat-card class="mat-elevation-z8" fxFlexOffset="25px" fxLayout="column" fxLayoutAlign="center center">
        <mat-card-title>Please login to view data</mat-card-title>
        <button mat-raised-button (click)="login()" color="primary">
          <img src="/assets/btn_google_light_normal_ios.svg">
          Sign in with Google
        </button>
      </mat-card>
    </div>
  </ng-template>
</div>
